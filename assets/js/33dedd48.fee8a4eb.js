"use strict";(self.webpackChunkflutter_news_toolkit_docs=self.webpackChunkflutter_news_toolkit_docs||[]).push([[277],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>u});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=a.createContext({}),c=function(e){var t=a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),h=c(r),u=n,f=h["".concat(s,".").concat(u)]||h[u]||d[u]||o;return r?a.createElement(f,i(i({ref:t},p),{},{components:r})):a.createElement(f,i({ref:t},p))}));function u(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var c=2;c<o;c++)i[c]=r[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}h.displayName="MDXCreateElement"},7695:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var a=r(7462),n=(r(7294),r(3905));const o={sidebar_position:10,description:"Learn how the toolkit caches your news application's state."},i="Cache your application state",l={unversionedId:"flutter_development/cache_application_state",id:"flutter_development/cache_application_state",title:"Cache your application state",description:"Learn how the toolkit caches your news application's state.",source:"@site/docs/flutter_development/cache_application_state.md",sourceDirName:"flutter_development",slug:"/flutter_development/cache_application_state",permalink:"/news_toolkit/flutter_development/cache_application_state",draft:!1,editUrl:"https://github.com/flutter/news_toolkit/tree/main/docs/docs/flutter_development/cache_application_state.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10,description:"Learn how the toolkit caches your news application's state."},sidebar:"tutorialSidebar",previous:{title:"In-app purchases",permalink:"/news_toolkit/flutter_development/in_app_purchases"},next:{title:"Privacy policy & terms of service",permalink:"/news_toolkit/flutter_development/privacy_policy"}},s={},c=[{value:"How it works",id:"how-it-works",level:2},{value:"Debug mode caching",id:"debug-mode-caching",level:2}],p={toc:c};function d(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"cache-your-application-state"},"Cache your application state"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://pub.dev/packages/hydrated_bloc"},"Hydrated Bloc")," is an extension to the BLoC pattern. It helps automatically persist and restore bloc states, ensuring that the app's state is retained across app restarts or crashes."),(0,n.kt)("p",null,"The project relies on ",(0,n.kt)("inlineCode",{parentName:"p"},"hydrated_bloc")," to persist the state of the following blocs:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"feed_bloc"),": Persists the feed state. It contains the list of feed articles fetched from the API."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"article_bloc")," : Persists each article information fetched from the API."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"categories_bloc"),": Persists all feed categories fetched from the API."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"theme_mode_bloc")," : Persists the theme mode of the app selected by the user.")),(0,n.kt)("h2",{id:"how-it-works"},"How it works"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"hydrated_bloc")," package uses its own ",(0,n.kt)("inlineCode",{parentName:"p"},"hydrated_storage")," to persist the state of blocs on the application's side. It is enabled by default."),(0,n.kt)("p",null,"Upon launching the application, if the feed state is empty, it retrieves the feed articles from the API. If the feed state is not empty, it displays the cached feed articles. As the user scrolls to the end of the feed page, older feed articles are fetched from the API and added to the feed state that will be persisted."),(0,n.kt)("p",null,"Actions such as opening the app from background or terminated state will not affect the state of the blocs. Those will be persisted and restored when the user restarts the app."),(0,n.kt)("p",null,"In order for the user to see the most recent articles, they must refresh the feed by pulling down the feed page."),(0,n.kt)("p",null,"If there are any errors while fetching the feed articles, the user will be notified by a 'Network Error' screen. The user can retry fetching the articles by tapping on the 'Retry' button."),(0,n.kt)("h2",{id:"debug-mode-caching"},"Debug mode caching"),(0,n.kt)("p",null,"In this project, ",(0,n.kt)("inlineCode",{parentName:"p"},"hydrated_bloc")," caching is automatically disabled for debug mode. Every restart of the application will clear the ",(0,n.kt)("inlineCode",{parentName:"p"},"hydrated_bloc")," storage state, so no state will be restored. In order to enable it, the following code must be removed from the ",(0,n.kt)("inlineCode",{parentName:"p"},"bootstrap.dart")," file:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-dart"},"if (kDebugMode) {\n    await HydratedBloc.storage.clear();\n}\n")))}d.isMDXComponent=!0}}]);